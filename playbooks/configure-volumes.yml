---
- name: Format and mount additional ebs volumes on ec2 after the instance launched (NVMe version).
  hosts: localhost
  connection: local
  gather_facts: true
  become: no
  tasks:
    - set_fact:
        use_nvme_playbook: false

    # @TODO: I'm sure we will need to add more OSes here, but this is a start.
    - set_fact:
        use_nvme_playbook: true
      when: ansible_distribution == "OracleLinux"
        and ansible_distribution_major_version == "7"

    - include_tasks: ./configure-volumes-by-nvme.yml
      when: use_nvme_playbook

    - include_tasks: ./configure-volumes-by-ebs-metadata.yml
      when: not use_nvme_playbook
